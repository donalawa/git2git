let Conf,configKey,getRemote,pushGitlab,throws;_2aa‍.x([["pushAll",()=>pushAll]]);_2aa‍.w("conf",[["default",["Conf"],function(v){Conf=v}]]);_2aa‍.w("./config",[["configKey",["configKey"],function(v){configKey=v}]]);_2aa‍.w("./utils",[["getRemote",["getRemote"],function(v){getRemote=v}],["pushGitlab",["pushGitlab"],function(v){pushGitlab=v}]]);_2aa‍.w("assert",[["throws",["throws"],function(v){throws=v}]]);/**
* Description of the file. Add link pointers with {@link link
    name}
    * @author Donacien
    * @date 13/08/2020
    * Contributors : contributor name,
**/


// import Table from 'cli-table3';




const fs = require('fs')
const chalk = require('chalk')

const { readdirSync } = require('fs')

const{ execSync } = require('child_process');
//TODO: Complete the add all commands to get all project names and loop through and get updates


       async function pushAll(args) {
  const config = new Conf().get(configKey);

  const localPath = config.local;
  const onlinePath = config.online;

  let projects = [];

  let source = localPath;

  const getDirectories = source =>
  readdirSync(source, { withFileTypes: true })
    .filter(dirent => dirent.isDirectory())
    .map(dirent => dirent.name)

  projects = getDirectories(source);
  _2aa‍.g.console.log(args)
  _2aa‍.g.console.log(projects)
  for(let i = 0; i < projects.length; i++) {
      let Pname = projects[i];
      let commitMessage = args[1];
      let branch = 'master'
      
      let remote = getRemote(localPath,Pname);
      
        try {
       
            //Pull updates for all projects
            execSync(`git pull ${remote}`,{
                cwd: `${localPath}/${Pname}`
                })
        } catch (error) {
            throw new Error(error)
        }
      pushGitlab(onlinePath,Pname,remote,branch,commitMessage);
  }
  _2aa‍.g.console.log(chalk.blueBright(`Done All Pushed Successfully To Gitlab`))
}
